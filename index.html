<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generador de Reportes - Marketing View</title>
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #FFA947 0%, #FF8C1A 50%, #FF9933 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    h1 { color: #333; margin-bottom: 30px; font-size: 32px; text-align: center; }
    
    .company-selector {
      margin: 30px 0;
      padding: 30px;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
      border-radius: 12px;
    }
    .company-selector h2 { color: #333; margin-bottom: 20px; font-size: 24px; text-align: center; }
    
    .dropdown-container { max-width: 500px; margin: 0 auto; }
    .dropdown-container label { display: block; font-size: 16px; font-weight: 600; color: #555; margin-bottom: 10px; }
    .dropdown-container select {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      border: 2px solid #ddd;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      transition: all 0.3s;
    }
    .dropdown-container select:hover { border-color: #00BFFF; }
    
    .add-company-btn {
      display: block;
      margin: 20px auto 0;
      background: #4caf50;
      color: white;
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .generate-button {
      background: linear-gradient(135deg, #00BFFF 0%, #00A3E0 100%);
      color: white;
      padding: 20px 50px;
      border: none;
      border-radius: 12px;
      font-size: 20px;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      margin: 30px 0;
      display: none;
    }
    .generate-button.active { display: block; }
    
    .status { margin-top: 20px; padding: 15px; border-radius: 8px; display: none; text-align: center; }
    .status.loading { background: #e3f2fd; color: #1976d2; display: block; }
    .status.success { background: #e8f5e9; color: #2e7d32; display: block; }
    
    .results { margin-top: 30px; padding: 30px; background: #f8f9fa; border-radius: 12px; display: none; }
    .report-content { background: white; padding: 40px; border-radius: 10px; line-height: 2; white-space: pre-wrap; }
    .chart-container { margin-bottom: 40px; background: white; padding: 20px; border-radius: 8px; }
    .download-btn { display: inline-block; background: #4caf50; color: white; padding: 14px 30px; border-radius: 8px; text-decoration: none; margin-top: 20px; }
    .back-btn { background: #666; color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìä Generador de Reportes - Marketing View</h1>
    
    <div class="company-selector" id="companySelector">
      <h2>Selecciona la Empresa</h2>
      <div class="dropdown-container">
        <label for="companyDropdown">Empresa:</label>
        <select id="companyDropdown" onchange="selectCompany()">
          <option value="">-- Selecciona una empresa --</option>
          <option value="adiestra">üêæ Adiestra - Educaci√≥n Canina</option>
          <option value="dentalcrea">ü¶∑ DentalCrea - Cl√≠nica Dental</option>
        </select>
        <button class="add-company-btn" onclick="addNewCompany()">‚ûï Agregar Nueva Empresa</button>
      </div>
    </div>
    
    <button class="generate-button" id="generateBtn" onclick="generateReport()">
      üöÄ Generar Reporte de Diciembre 2025
    </button>
    
    <div id="status" class="status"></div>
    
    <div id="results" class="results">
      <button class="back-btn" onclick="backToSelection()">‚Üê Volver</button>
      <h2>üìÑ Reporte Generado</h2>
      <div id="reportContent" class="report-content"></div>
      
      <div class="charts-section">
        <h3 style="color: #00BFFF; margin-bottom: 20px;">üìà Gr√°ficas de Rendimiento</h3>
        <div class="chart-container" id="chartFacebook"></div>
        <div class="chart-container" id="chartInstagramReach"></div>
        <div class="chart-container" id="chartInstagramImpressions"></div>
      </div>
      
      <a id="downloadLink" class="download-btn">üì• Descargar Reporte</a>
    </div>
  </div>

  <script>
    let selectedCompany = null;
    
    const companiesData = {
      adiestra: {
        company: "Adiestra",
        currentMonth: {
          month: 12, year: 2025,
          fb_followers_current: 2540, fb_followers_previous: 2541, fb_new_followers: 0, fb_unfollows: 1,
          fb_views_current: 979, fb_views_previous: 31472, fb_reach_current: 533, fb_reach_previous: 23914,
          fb_interactions_current: 10, fb_interactions_previous: 1594,
          fb_best_posts: ["Una buena convivencia en casa", "üêæ Travesuras", "‚ú® Confianza paso a paso", "üëâüèº Qu√© llevar al paseo"],
          ig_followers_current: 1882, ig_followers_previous: 1876, ig_new_followers: 6, ig_unfollows: 0,
          ig_views_current: 96, ig_views_previous: 4836, ig_reach_current: 2036, ig_reach_previous: 1150,
          ig_interactions_current: 70, ig_interactions_previous: 99,
          ig_likes_posts: 31, ig_likes_reels: 12, ig_saves_posts: 1, ig_saves_reels: 0, ig_shares_posts: 1, ig_shares_reels: 4,
          ig_best_post: "Mejor Post: 371 visualizaciones", ig_best_reel: "Mejor Reel: 320 visualizaciones",
          ig_impressions_total: 2243, ig_profile_visits: 102
        },
        historical: {
          months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
          fb_interactions: [113, 114, 138, 116, 117, 111, 114, 113, 114, 1481, 1594, 10],
          fb_reach: [146, 112, 171, 116, 141, 136, 112, 136, 131, 19476, 23914, 533],
          ig_reach: [502, 1251, 1756, 636, 1119, 961, 682, 1902, 1595, 1347, 1150, 2036],
          ig_visits: [55, 416, 131, 182, 97, 101, 119, 352, 258, 195, 99, 102],
          ig_impressions: [3130, 5427, 5746, 2433, 2971, 2578, 2669, 9097, 6877, 6401, 4836, 2243]
        }
      },
      dentalcrea: {
        company: "DentalCrea",
        currentMonth: {
          month: 12, year: 2025,
          fb_followers_current: 180, fb_followers_previous: 180, fb_new_followers: 0, fb_unfollows: 0,
          fb_views_current: 482, fb_views_previous: 338, fb_reach_current: 166, fb_reach_previous: 45,
          fb_interactions_current: 4, fb_interactions_previous: 5,
          fb_best_posts: ["3 claves para cuidarte", "üåø Mini-implantes ortodoncia", "¬øSab√≠as que el dise√±o de sonrisa...?"],
          ig_followers_current: 1151, ig_followers_previous: 1145, ig_new_followers: 6, ig_unfollows: 0,
          ig_views_current: 11895, ig_views_previous: 11895, ig_reach_current: 781, ig_reach_previous: 781,
          ig_interactions_current: 54, ig_interactions_previous: 54,
          ig_likes_posts: 7, ig_likes_reels: 82, ig_saves_posts: 0, ig_saves_reels: 12, ig_shares_posts: 1, ig_shares_reels: 2,
          ig_best_post: "Mejor Post: 589 visualizaciones", ig_best_reel: "Mejor Reel: Ortodoncia educativa - 3,543 views",
          ig_impressions_total: 11895, ig_profile_visits: 59
        },
        historical: {
          months: ['Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
          fb_interactions: [9, 12, 14, 3, 6, 10, 11, 4],
          fb_reach: [91, 88, 87, 96, 68, 59, 45, 166],
          ig_reach: [1735, 1390, 1480, 5384, 3982, 1098, 781, 781],
          ig_visits: [405, 399, 318, 313, 307, 441, 333, 59],
          ig_impressions: [9539, 7568, 13109, 21077, 19805, 14616, 11895, 11895]
        }
      }
    };

    function selectCompany() {
      const dropdown = document.getElementById('companyDropdown');
      selectedCompany = dropdown.value;
      const btn = document.getElementById('generateBtn');
      if (selectedCompany) btn.classList.add('active');
      else btn.classList.remove('active');
    }

    function backToSelection() {
      document.getElementById('results').style.display = 'none';
      document.getElementById('companySelector').style.display = 'block';
      document.getElementById('status').style.display = 'none';
      document.getElementById('generateBtn').style.display = 'block';
    }

    function generateReport() {
      const status = document.getElementById('status');
      status.className = 'status loading';
      status.textContent = '‚è≥ Generando reporte...';
      document.getElementById('companySelector').style.display = 'none';
      document.getElementById('generateBtn').style.display = 'none';

      setTimeout(() => {
        const data = companiesData[selectedCompany];
        const reportText = generateReportText(data);
        document.getElementById('reportContent').textContent = reportText;
        document.getElementById('results').style.display = 'block';
        generateCharts(data);
        
        const blob = new Blob([reportText], { type: 'text/plain' });
        const link = document.getElementById('downloadLink');
        link.href = URL.createObjectURL(blob);
        link.download = `Reporte_${data.company}_Dic_2025.txt`;
        
        status.className = 'status success';
        status.textContent = '‚úÖ Reporte completado';
      }, 800);
    }

    function generateReportText(data) {
      const d = data.currentMonth;
      return `# REPORTE MENSUAL: ${data.company.toUpperCase()} - DICIEMBRE 2025

## M√âTRICAS DE SEGUIDORES
Facebook: ${d.fb_followers_current} (${d.fb_new_followers} nuevos, ${d.fb_unfollows} bajas)
Instagram: ${d.ig_followers_current} (${d.ig_new_followers} nuevos, ${d.ig_unfollows} bajas)

## RENDIMIENTO FACEBOOK
- Alcance: ${d.fb_reach_current} (Previo: ${d.fb_reach_previous})
- Visualizaciones: ${d.fb_views_current} (Previo: ${d.fb_views_previous})
- Interacciones: ${d.fb_interactions_current}

## RENDIMIENTO INSTAGRAM
- Alcance: ${d.ig_reach_current} (Previo: ${d.ig_reach_previous})
- Impresiones Totales: ${d.ig_impressions_total}
- Interacciones Totales: ${d.ig_interactions_current}
  * Likes: ${d.ig_likes_posts} (Posts) / ${d.ig_likes_reels} (Reels)
  * Guardados: ${d.ig_saves_posts + d.ig_saves_reels}

## MEJORES CONTENIDOS
${d.fb_best_posts.map(p => `- FB: ${p}`).join('\n')}
- IG Post: ${d.ig_best_post}
- IG Reel: ${d.ig_best_reel}

## CONCLUSIONES FINALES
${data.company === 'Adiestra' ? 
'Diciembre represent√≥ una normalizaci√≥n tras el pico at√≠pico de Noviembre. Facebook regres√≥ a niveles hist√≥ricos base, mientras Instagram duplic√≥ su alcance org√°nico.' : 
'Facebook mostr√≥ una recuperaci√≥n s√≥lida en alcance (+260%), mientras que Instagram se mantuvo como el pilar de credibilidad con visualizaciones constantes en contenido educativo.'}`;
    }

    function generateCharts(data) {
      const commonLayout = { barmode: 'group', height: 400, margin: { t: 50, b: 80 } };
      const h = data.historical;

      Plotly.newPlot('chartFacebook', [
        { x: h.months, y: h.fb_interactions, name: 'Interacciones', type: 'bar', marker: {color: '#9b59b6'} },
        { x: h.months, y: h.fb_reach, name: 'Alcance', type: 'bar', marker: {color: '#66cc99'} }
      ], { ...commonLayout, title: 'Hist√≥rico Facebook 2025' });

      Plotly.newPlot('chartInstagramReach', [
        { x: h.months, y: h.ig_reach, name: 'Alcance IG', type: 'bar', marker: {color: '#3498db'} },
        { x: h.months, y: h.ig_visits, name: 'Visitas Perfil', type: 'bar', marker: {color: '#f1c40f'} }
      ], { ...commonLayout, title: 'Alcance y Visitas Instagram' });

      Plotly.newPlot('chartInstagramImpressions', [
        { x: h.months, y: h.ig_impressions, name: 'Impresiones', type: 'scatter', mode: 'lines+markers', line: {color: '#e74c3c'} }
      ], { ...commonLayout, title: 'Tendencia de Impresiones IG' });
    }

    function addNewCompany() { alert('Funci√≥n en desarrollo.'); }
  </script>
</body>
</html>
